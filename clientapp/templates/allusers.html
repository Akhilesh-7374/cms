{% extends "home.html" %}
{% block title %}All Users{% endblock %}

{% block content %}
<center>
  <h2>All Users</h2>

  <form method="get" style="margin-bottom: 28px;">
    <input type="text" name="query" value="{{ query }}" placeholder="Search by User Name">
    
    <select name="role">
      <option value="">All Roles</option>
      {% for r in roles %}
        <option value="{{ r }}" {% if r == role %}selected{% endif %}>{{ r }}</option>
      {% endfor %}
    </select>

    <button type="submit">Search</button>
  </form>

  <table border="1" cellpadding="5" cellspacing="0" width="50%">
    <thead style="background-color:orange">
      <tr>
        <th>User Name</th>
        <th>Role</th>
        <th>Edit</th>
        <th>Delete</th>
      </tr>
    </thead>
    <tbody>
      {% for user in users %}
      <tr>
        <td>{{ user.user_id }}</td>
        <td>{{ user.get_role_display }}</td>
        <td><a href="{% url 'edituser' user.id %}">Edit</a></td>
        <td><a href="{% url 'deleteuser' user.id %}" onclick="return confirm('Are you sure you want to delete this user?');">Delete</a></td>
      </tr>
      {% empty %}
      <tr><td colspan="4">No users found</td></tr>
      {% endfor %}
    </tbody>
  </table>
</center>
{% endblock %}
